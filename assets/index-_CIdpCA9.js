import{d as L,r as m,a as y,o as g,c as k,b as f,u as o,i as h,e as s,w as S,f as b,g as $,h as _,j as V,p as q,k as A,s as x,l as T,m as I,n as K,t as z,q as N,v as E}from"./index-WGhUwIKY.js";import{_ as O}from"./_plugin-vue_export-helper-x3n3nnut.js";const H="/vue-template/common/logoTitle.svg",P="/vue-template/login/titleLogo.svg",j="/vue-template/common/homeLogo.svg",D=r=>(q("data-v-0b0aafe0"),r=r(),A(),r),M={class:"login-content"},W={class:"login-reset"},F={class:"login-bottom-button"},G=D(()=>s("span",null,"立即注册",-1)),J=L({__name:"login",setup(r){const{setToken:n,setLoginState:v}=$.authStore,a=m(""),l=m("");m("+86");const i=async()=>{if(!a.value||!/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/g.test(a.value)||!l.value||!l.value.trim())return;let t=await _.request.post("account/loginByPassword",{mobileArea:"+86",mobile:a.value,password:l.value,appHigh:3});t.msg==="OK"&&(localStorage.clear(),n(t.data.token),_.setToken(t.data.token),V.replace("/home"))};return(u,t)=>{const d=y("el-input"),w=y("el-button");return g(),k("div",M,[f(d,{modelValue:o(a),"onUpdate:modelValue":t[0]||(t[0]=c=>h(a)?a.value=c:null),placeholder:"请输入手机号",class:"login-input",size:"large"},null,8,["modelValue"]),f(d,{modelValue:o(l),"onUpdate:modelValue":t[1]||(t[1]=c=>h(l)?l.value=c:null),type:"password",placeholder:"请输入密码","show-password":"",class:"login-input",size:"large"},null,8,["modelValue"]),s("div",W,[s("div",{onClick:t[2]||(t[2]=c=>o(v)("codeLogin"))},"验证码登录"),s("div",{onClick:t[3]||(t[3]=c=>o(v)("reset"))},"找回密码")]),s("div",F,[f(w,{type:"primary",class:"login-button",onClick:t[4]||(t[4]=c=>i())},{default:S(()=>[b(" 登录 ")]),_:1}),s("div",{class:"login-prompt",onClick:t[5]||(t[5]=c=>o(v)("register"))},[b(" 没有场景英语账户？"),G])])])}}}),Q=O(J,[["__scopeId","data-v-0b0aafe0"]]),U=r=>(q("data-v-bf4d58f0"),r=r(),A(),r),X={class:"reset-content"},Y={class:"reset-code"},Z={class:"login-bottom-button"},ee={class:"login-prompt dp-space-center"},te=U(()=>s("span",null,"登录",-1)),oe=U(()=>s("span",null,"立即注册",-1)),se=[oe],le=L({__name:"reset",setup(r){const{loginState:n}=x($.authStore),{setToken:v,setLoginState:a}=$.authStore,l=m(""),i=m(""),u=m(""),t=m(!1),d=m(60),w=async()=>{if((await _.request.post("account/vertifyCode",{mobileArea:"+86",mobile:l.value,source:n.value==="register"?1:n.value==="reset"?3:2})).msg==="OK"){t.value=!0;let e=setInterval(()=>{d.value===0&&(t.value=!1,clearInterval(e)),d.value=d.value-1},1e3)}},c=async()=>{if(/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/g.test(l.value)&&!(n.value!=="codeLogin"&&(!i.value||!i.value.trim()))){if(n.value==="register"){const e=await _.request.post("account",{mobileArea:"+86",mobile:l.value,password:i.value,code:u.value});e.msg==="OK"&&(v(e.data.token),_.setToken(e.data.token),V.replace("/home"))}else if(n.value==="reset")(await _.request.patch("account/pwdSet",{mobileArea:"+86",mobile:l.value,password:i.value,code:u.value})).msg==="OK"&&a("login");else if(n.value==="codeLogin"){const e=await _.request.get("account/getTempToken",{mobileArea:"+86",mobile:l.value,code:u.value});e.msg==="OK"&&(localStorage.clear(),v(e.data.token),_.setToken(e.data.token),V.replace("/home"))}}};return(R,e)=>{const C=y("el-input"),B=y("el-button");return g(),k("div",X,[f(C,{modelValue:o(l),"onUpdate:modelValue":e[0]||(e[0]=p=>h(l)?l.value=p:null),placeholder:"请输入手机号",size:"large",class:"login-input"},null,8,["modelValue"]),o(n)!=="codeLogin"?(g(),T(C,{key:0,modelValue:o(i),"onUpdate:modelValue":e[1]||(e[1]=p=>h(i)?i.value=p:null),type:"password",placeholder:"请输入密码","show-password":"",class:"login-input",size:"large"},null,8,["modelValue"])):I("",!0),s("div",Y,[f(C,{modelValue:o(u),"onUpdate:modelValue":e[2]||(e[2]=p=>h(u)?u.value=p:null),placeholder:"请输入验证码",autocomplete:"new-password",size:"large",class:"login-input",style:K({width:"calc(100% - 55px)",marginBottom:"0px"})},null,8,["modelValue","style"]),f(B,{type:"primary",onClick:e[3]||(e[3]=p=>w()),disabled:o(t),style:{marginLeft:"5px"},size:"large"},{default:S(()=>[b(z(o(t)?`剩余${o(d)}秒`:"获取验证码"),1)]),_:1},8,["disabled"])]),s("div",Z,[f(B,{type:"primary",class:"login-button",onClick:e[4]||(e[4]=p=>c())},{default:S(()=>[b(z(o(n)==="register"?"注册账号":o(n)==="reset"?"重置密码":"验证码登录"),1)]),_:1}),s("div",ee,[s("div",{onClick:e[5]||(e[5]=p=>o(a)("login"))},[b("有账号? 去"),te]),o(n)!=="register"?(g(),k("div",{key:0,onClick:e[6]||(e[6]=p=>o(a)("register"))},se)):I("",!0)])])])}}}),ne=O(le,[["__scopeId","data-v-bf4d58f0"]]),ae={key:0,class:"login-box"},ie=s("div",{class:"login-logo"},[s("img",{src:H,alt:""})],-1),re={class:"login-container"},ue=s("div",{class:"login-bottom"},[b(" 登录或注册代表你同意 "),s("a",{href:"https://notecute.com/#/post?key=1499044542&view=digest&hideHead=1&publicShare=1&isWebview=1",target:"_blank"},"用户条款")],-1),de={key:1,class:"title-box"},ce=s("img",{class:"title-login-logo",src:P,alt:""},null,-1),pe={class:"title-header"},me=s("img",{class:"title-header-logo",src:j,alt:""},null,-1),_e=L({__name:"index",setup(r){const n="/vue-template/",{loginState:v,token:a}=x($.authStore),{deviceType:l}=x($.commonStore),i=m(!1);return N(()=>{console.log(a.value),a.value&&V.replace(`${n}home`)}),(u,t)=>{const d=y("el-button");return g(),k("div",{class:E(["login",{"login-phone":o(l)==="phone"}]),style:K({backgroundImage:`url('/common/${o(l)==="pc"?"commonBg":"commonPhoneBg"}.png')`})},[o(i)?(g(),k("div",ae,[ie,s("div",re,[o(v)==="login"?(g(),T(Q,{key:0})):(g(),T(ne,{key:1}))]),ue])):(g(),k("div",de,[ce,s("div",pe,[me,f(d,{type:"primary",onClick:t[0]||(t[0]=w=>o(a)?u.$router.replace("/home"):i.value=!0),class:"title-login-button",round:""},{default:S(()=>[b("立即体验 ")]),_:1})])]))],6)}}});export{_e as default};
