import{d as L,r as g,a as y,o as v,c as k,b as f,u as o,i as h,e as l,w as S,f as b,g as $,h as _,j as V,p as q,k as A,s as x,l as T,m as I,n as O,t as z,q as N,v as E}from"./index-e2D1QTuC.js";const H="/vue-template/common/logoTitle.svg",P="/vue-template/login/titleLogo.svg",j="/vue-template/common/homeLogo.svg",D=i=>(q("data-v-0b0aafe0"),i=i(),A(),i),M={class:"login-content"},W={class:"login-reset"},F={class:"login-bottom-button"},G=D(()=>l("span",null,"立即注册",-1)),J=L({__name:"login",setup(i){const{setToken:n,setLoginState:u}=$.authStore,a=g(""),s=g("");g("+86");const r=async()=>{if(!a.value||!/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/g.test(a.value)||!s.value||!s.value.trim())return;let t=await _.request.post("account/loginByPassword",{mobileArea:"+86",mobile:a.value,password:s.value,appHigh:3});t.msg==="OK"&&(localStorage.clear(),n(t.data.token),_.setToken(t.data.token),V.replace("/home"))};return(d,t)=>{const c=y("el-input"),w=y("el-button");return v(),k("div",M,[f(c,{modelValue:o(a),"onUpdate:modelValue":t[0]||(t[0]=p=>h(a)?a.value=p:null),placeholder:"请输入手机号",class:"login-input",size:"large"},null,8,["modelValue"]),f(c,{modelValue:o(s),"onUpdate:modelValue":t[1]||(t[1]=p=>h(s)?s.value=p:null),type:"password",placeholder:"请输入密码","show-password":"",class:"login-input",size:"large"},null,8,["modelValue"]),l("div",W,[l("div",{onClick:t[2]||(t[2]=p=>o(u)("codeLogin"))},"验证码登录"),l("div",{onClick:t[3]||(t[3]=p=>o(u)("reset"))},"找回密码")]),l("div",F,[f(w,{type:"primary",class:"login-button",onClick:t[4]||(t[4]=p=>r())},{default:S(()=>[b(" 登录 ")]),_:1}),l("div",{class:"login-prompt",onClick:t[5]||(t[5]=p=>o(u)("register"))},[b(" 没有场景英语账户？"),G])])])}}}),K=(i,n)=>{const u=i.__vccOpts||i;for(const[a,s]of n)u[a]=s;return u},Q=K(J,[["__scopeId","data-v-0b0aafe0"]]),U=i=>(q("data-v-bf4d58f0"),i=i(),A(),i),X={class:"reset-content"},Y={class:"reset-code"},Z={class:"login-bottom-button"},ee={class:"login-prompt dp-space-center"},te=U(()=>l("span",null,"登录",-1)),oe=U(()=>l("span",null,"立即注册",-1)),se=[oe],le=L({__name:"reset",setup(i){const{loginState:n}=x($.authStore),{setToken:u,setLoginState:a}=$.authStore,s=g(""),r=g(""),d=g(""),t=g(!1),c=g(60),w=async()=>{if((await _.request.post("account/vertifyCode",{mobileArea:"+86",mobile:s.value,source:n.value==="register"?1:n.value==="reset"?3:2})).msg==="OK"){t.value=!0;let e=setInterval(()=>{c.value===0&&(t.value=!1,clearInterval(e)),c.value=c.value-1},1e3)}},p=async()=>{if(/^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/g.test(s.value)&&!(n.value!=="codeLogin"&&(!r.value||!r.value.trim()))){if(n.value==="register"){const e=await _.request.post("account",{mobileArea:"+86",mobile:s.value,password:r.value,code:d.value});e.msg==="OK"&&(u(e.data.token),_.setToken(e.data.token),V.replace("/home"))}else if(n.value==="reset")(await _.request.patch("account/pwdSet",{mobileArea:"+86",mobile:s.value,password:r.value,code:d.value})).msg==="OK"&&a("login");else if(n.value==="codeLogin"){const e=await _.request.get("account/getTempToken",{mobileArea:"+86",mobile:s.value,code:d.value});e.msg==="OK"&&(localStorage.clear(),u(e.data.token),_.setToken(e.data.token),V.replace("/home"))}}};return(R,e)=>{const C=y("el-input"),B=y("el-button");return v(),k("div",X,[f(C,{modelValue:o(s),"onUpdate:modelValue":e[0]||(e[0]=m=>h(s)?s.value=m:null),placeholder:"请输入手机号",size:"large",class:"login-input"},null,8,["modelValue"]),o(n)!=="codeLogin"?(v(),T(C,{key:0,modelValue:o(r),"onUpdate:modelValue":e[1]||(e[1]=m=>h(r)?r.value=m:null),type:"password",placeholder:"请输入密码","show-password":"",class:"login-input",size:"large"},null,8,["modelValue"])):I("",!0),l("div",Y,[f(C,{modelValue:o(d),"onUpdate:modelValue":e[2]||(e[2]=m=>h(d)?d.value=m:null),placeholder:"请输入验证码",autocomplete:"new-password",size:"large",class:"login-input",style:O({width:"calc(100% - 55px)",marginBottom:"0px"})},null,8,["modelValue","style"]),f(B,{type:"primary",onClick:e[3]||(e[3]=m=>w()),disabled:o(t),style:{marginLeft:"5px"},size:"large"},{default:S(()=>[b(z(o(t)?`剩余${o(c)}秒`:"获取验证码"),1)]),_:1},8,["disabled"])]),l("div",Z,[f(B,{type:"primary",class:"login-button",onClick:e[4]||(e[4]=m=>p())},{default:S(()=>[b(z(o(n)==="register"?"注册账号":o(n)==="reset"?"重置密码":"验证码登录"),1)]),_:1}),l("div",ee,[l("div",{onClick:e[5]||(e[5]=m=>o(a)("login"))},[b("有账号? 去"),te]),o(n)!=="register"?(v(),k("div",{key:0,onClick:e[6]||(e[6]=m=>o(a)("register"))},se)):I("",!0)])])])}}}),ne=K(le,[["__scopeId","data-v-bf4d58f0"]]),ae={key:0,class:"login-box"},ie=l("div",{class:"login-logo"},[l("img",{src:H,alt:""})],-1),re={class:"login-container"},ue=l("div",{class:"login-bottom"},[b(" 登录或注册代表你同意 "),l("a",{href:"https://notecute.com/#/post?key=1499044542&view=digest&hideHead=1&publicShare=1&isWebview=1",target:"_blank"},"用户条款")],-1),de={key:1,class:"title-box"},ce=l("img",{class:"title-login-logo",src:P,alt:""},null,-1),pe={class:"title-header"},me=l("img",{class:"title-header-logo",src:j,alt:""},null,-1),ve=L({__name:"index",setup(i){const n="/vue-template/",{loginState:u,token:a}=x($.authStore),{deviceType:s}=x($.commonStore),r=g(!1);return N(()=>{console.log(a.value),a.value&&V.replace(`${n}home`)}),(d,t)=>{const c=y("el-button");return v(),k("div",{class:E(["login",{"login-phone":o(s)==="phone"}]),style:O({backgroundImage:`url('/common/${o(s)==="pc"?"commonBg":"commonPhoneBg"}.png')`})},[o(r)?(v(),k("div",ae,[ie,l("div",re,[o(u)==="login"?(v(),T(Q,{key:0})):(v(),T(ne,{key:1}))]),ue])):(v(),k("div",de,[ce,l("div",pe,[me,f(c,{type:"primary",onClick:t[0]||(t[0]=w=>o(a)?d.$router.replace("/home"):r.value=!0),class:"title-login-button",round:""},{default:S(()=>[b("立即体验 ")]),_:1})])]))],6)}}});export{ve as default};
